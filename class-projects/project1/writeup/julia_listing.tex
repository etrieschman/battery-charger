\usepackage[utf8]{inputenc}
\usepackage{textcomp}
\DeclareUnicodeCharacter{00B1}{\ifmmode\pm\else\textpm\fi}
\usepackage{listingsutf8}
\usepackage{mdframed}
\usepackage{xcolor}
%%
%% Julia syntax highlighting (c) Robert Moss
%%
\lstdefinelanguage{Julia}%
  {keywords=[2]{Tuple, flush, primes, Type, flush_cstdio, print, TypeConstructor, foldl, print_escaped, TypeError, foldr, print_joined, TypeName, print_shortest, TypeVar, frexp, print_unescaped, UTF16String, full, print_with_color, UTF32String, fullname, println, UTF8String, process_exited, UdpSocket, functionloc, process_running, Uint, functionlocs, procs, Uint128, gamma, prod, Uint16, gc, prod!, Uint32, gc_disable, produce, Uint64, gc_enable, promote, Uint8, gcd, promote_rule, UndefRefError, gcdx, promote_shape, UndefVarError, gensym, promote_type, UniformScaling, get, push!, Union, get!, pushdisplay, UnionType, get_bigfloat_precision, put, UnitRange, get_bigfloat_rounding, put!, Unsigned, get_rounding, pwd, VERSION, getaddrinfo, qr, Vararg, getfield, qrfact, VecOrMat, gethostname, qrfact!, Vector, getindex, quadgk, VersionNumber, getipaddr, quantile, Void, getkey, quantile!, WORD_SIZE, getpid, quit, WString, givens, WeakKeyDict, global, rad2deg, WeakRef, golden, radians2degrees, WindowsRawSocket, gperm, rand, Woodbury, gradient, rand!, Zip, hankelh1, randbool, hankelh1x, randbool!, hankelh2, randcycle, abs, hankelh2x, randn, abs2, hash, randn!, abspath, haskey, randperm, hcat, randstring, accept, help, randsubseq, @MIME, acos, hessfact, randsubseq!, @MIME_str, acosd, hessfact!, range, @__FILE__, acosh, hex, rank, @allocated, acot, hex2bytes, rationalize, @assert, acotd, hex2num, read, @async, acoth, hist, read!, @b_str, acsc, hist2d, readall, @bigint_str, acscd, histrange, readandwrite, @boundscheck, acsch, homedir, readavailable, @cmd, addprocs, htol, readbytes, @code_llvm, airy, hton, readbytes!, @code_lowered, airyai, hvcat, readchomp, @code_native, airyaiprime, hypot, readcsv, @code_typed, airybi, iceil, readdir, @deprecate, airybiprime, idct, readdlm, @edit, airyprime, idct!, readline, @elapsed, airyx, identity, readlines, @eval, all, readsfrom, @evalpoly, all!, ifelse, readuntil, @everywhere, angle, ifft, real, @fetch, ans, ifft!, realmax, @fetchfrom, any, ifftshift, realmin, @gensym, any!, ifloor, realpath, @goto, append!, ignorestatus, recv, @inbounds, applicable, im, redirect_stderr, @int128_str, apply, imag, redirect_stdin, @ip_str, apropos, redirect_stdout, @label, ascii, redisplay, @less, asec, reduce, @linux, asecd, in, reducedim, @linux_only, asech, include, reenable_sigint, @mstr, asin, include_string, reim, @non_windowsxp_only, asind, ind2chr, reinterpret, @osx, asinh, ind2sub, reload, @osx_only, assert, indexin, rem, @parallel, atan, indexpids, rem1, @printf, atan2, indmax, remotecall, @profile, atand, indmin, remotecall_fetch, @r_mstr, atanh, inf, remotecall_wait, @r_str, atexit, info, repeat, @schedule, backtrace, infs, replace, @show, baremodule, insert!, repmat, @simd, base, int, repr, @spawn, base64, int128, reprmime, @spawnat, basename, int16, require, @sprintf, int32, reset, @sync, beginswith, int64, reshape, @task, besselh, int8, resize!, @thunk, besseli, integer, rethrow, @time, besselix, interrupt, @timed, besselj, intersect, reverse, @uint128_str, besselj0, intersect!, reverse!, @unexpected, besselj1, inv, rfft, @unix, besseljx, invdigamma, rm, @unix_only, besselk, invmod, rmdir, @v_str, besselkx, invoke, rmprocs, @vectorize_1arg, bessely, invperm, rol, @vectorize_2arg, bessely0, ipermute!, ror, @which, bessely1, ipermutedims, rot180, @windows, besselyx, irfft, rotl90, @windows_only, beta, iround, rotr90, @windowsxp_only, bfft, is, round, ANY, bfft!, is_assigned_char, rpad, ARGS, big, is_valid_ascii, rref, ASCIIString, bin, is_valid_char, rsearch, A_ldiv_B!, bind, is_valid_utf16, rsearchindex, A_ldiv_Bc, binomial, is_valid_utf8, rsplit, A_ldiv_Bt, bitbroadcast, isa, rstrip, A_mul_B!, bitmix, isabspath, run, A_mul_Bc, bitpack, isalnum, scale, A_mul_Bc!, bits, isalpha, scale!, A_mul_Bt, bitstype, isapprox, schedule, A_mul_Bt!, bitunpack, isascii, schur, A_rdiv_Bc, bkfact, isbits, schurfact, A_rdiv_Bt, bkfact!, isblank, schurfact!, AbstractArray, blas_set_num_threads, isblockdev, sdata, AbstractMatrix, blkdiag, ischardev, search, AbstractRNG, bool, iscntrl, searchindex, AbstractSparseArray, break, isconst, searchsorted, AbstractSparseMatrix, brfft, isdefined, searchsortedfirst, AbstractSparseVector, broadcast, isdigit, searchsortedlast, AbstractVecOrMat, broadcast!, isdir, sec, AbstractVector, broadcast!_function, isdirpath, secd, Ac_ldiv_B, broadcast_function, iseltype, sech, Ac_ldiv_Bc, broadcast_getindex, isempty, seek, Ac_mul_B, broadcast_setindex!, isequal, seekend, Ac_mul_B!, bswap, iseven, seekstart, Ac_mul_Bc, bytes2hex, isexecutable, select, Ac_mul_Bc!, bytestring, isfifo, select!, Ac_rdiv_B, c_calloc, isfile, send, Ac_rdiv_Bc, c_free, isfinite, serialize, Any, c_malloc, isgeneric, set_bigfloat_precision, ArgumentError, c_realloc, isgraph, set_bigfloat_rounding, Array, cartesianmap, ishermitian, set_rounding, Associative, cat, isimmutable, setdiff, At_ldiv_B, catalan, isinf, setdiff!, At_ldiv_Bt, isinteger, setenv, At_mul_B, catch_backtrace, isinteractive, setfield, At_mul_B!, cbrt, isleaftype, setfield!, At_mul_Bt, ccall, isless, setindex!, At_mul_Bt!, cd, islink, shift!, At_rdiv_B, ceil, islower, show, At_rdiv_Bt, cell, ismarked, showall, BLAS, cfunction, ismatch, showcompact, Base, cglobal, isnan, showerror, Base64Pipe, char, isodd, shuffle, Bidiagonal, charwidth, isopen, shuffle!, BigFloat, checkbounds, ispath, sign, BigInt, chmod, isperm, signbit, BitArray, chol, isposdef, signed, BitMatrix, cholfact, isposdef!, signif, BitVector, cholfact!, ispow2, significand, Bool, chomp, isprime, similar, BoundsError, chop, isprint, sin, Box, chr2ind, ispunct, sinc, ByteString, circshift, isqrt, sind, CFILE, cis, isreadable, sinh, CPU_CORES, clamp, isreadonly, sinpi, C_NULL, clear_malloc_data, isready, size, Cchar, clipboard, isreal, sizehint, Cdouble, close, issetgid, sizeof, Cfloat, cmp, issetuid, skip, Char, code_llvm, issocket, skipchars, CharString, code_lowered, issorted, sleep, Cint, code_native, isspace, slice, Clong, code_typed, issparse, slicedim, Clonglong, collect, issticky, sort, ClusterManager, colon, issubnormal, sort!, Cmd, combinations, issubset, sortcols, Coff_t, complement, issubtype, sortperm, Collections, complement!, issym, sortrows, Colon, complex, istaskdone, sparse, Complex, complex128, istext, sparsevec, Complex128, complex32, istril, spawn, Complex32, complex64, istriu, spdiagm, Complex64, cond, isupper, speye, Condition, condskeel, isvalid, splice!, Core, conj, iswritable, split, Cptrdiff_t, conj!, isxdigit, splitdir, Cshort, connect, itrunc, splitdrive, Csize_t, join, splitext, Cssize_t, consume, joinpath, spones, Cuchar, contains, keys, sprand, Cuint, kill, sprandbool, Culong, conv, kron, sprandn, Culonglong, conv2, last, sprint, Cushort, convert, lbeta, spzeros, Cwchar_t, copy, lcfirst, sqrt, DArray, copy!, lcm, sqrtm, DL_LOAD_PATH, copysign, ldexp, squeeze, DataType, cor, ldltfact, srand, DenseArray, cos, ldltfact!, start, DenseMatrix, cosc, leading_ones, start_reading, DenseVecOrMat, cosd, leading_zeros, start_timer, DenseVector, cosh, length, start_watching, DevNull, cospi, less, stat, Diagonal, cot, let, std, Dict, cotd, lexcmp, stdm, DimensionMismatch, coth, lexless, step, Dims, count, lfact, stop_reading, DirectIndexString, count_ones, lgamma, stop_timer, Display, count_zeros, linrange, strerror, DivideError, countlines, linreg, strftime, DomainError, countnz, linspace, stride, ENDIAN_BOM, cov, listen, strides, ENV, cp, listenany, string, EOFError, cross, local, stringmime, EachLine, csc, localindexes, strip, Enumerate, cscd, localpart, strptime, ErrorException, csch, log, strwidth, Exception, ctime, log10, sub, Expr, ctranspose, log1p, sub2ind, FFTW, cummax, log2, subtypes, Factorization, cummin, logdet, success, FileMonitor, cumprod, logspace, sum, FileOffset, cumprod!, lowercase, sum!, Filter, cumsum, lpad, sum_kbn, Float16, cumsum!, lstat, sumabs, Float32, cumsum_kbn, lstrip, sumabs!, Float64, current_module, ltoh, sumabs2, FloatRange, current_task, lu, sumabs2!, FloatingPoint, dawson, lufact, summary, Function, dct, lufact!, super, GetfieldNode, dct!, lyap, svd, GotoNode, dec, svdfact, Graphics, deconv, macroexpand, svdfact!, Hermitian, deepcopy, map, svdvals, I, deg2rad, map!, svdvals!, IO, degrees2radians, mapreduce, sylvester, IOBuffer, delete!, mapslices, symbol, IOStream, deleteat!, mark, symdiff, IPv4, den, match, symdiff!, IPv6, dense, matchall, symlink, InexactError, deserialize, max, symperm, Inf, det, maxabs, systemerror, Inf16, detach, maxabs!, take, Inf32, dfill, maximum, take!, InsertionSort, diag, maximum!, takebuf_array, Int, diagind, maxintfloat, takebuf_string, Int128, diagm, mean, tan, Int16, diff, mean!, tand, Int32, digamma, median, tanh, Int64, digits, median!, task_local_storage, Int8, dirname, merge, tempdir, IntSet, disable_sigint, merge!, tempname, Integer, display, method_exists, throw, InterruptException, displayable, methods, tic, IntrinsicFunction, distribute, methodswith, time, Intrinsics, div, middle, time_ns, JULIA_HOME, divrem, midpoints, timedwait, KeyError, dlclose, mimewritable, toc, LAPACK, dlopen, min, toq, LOAD_PATH, dlopen_e, minabs, touch, LabelNode, dlsym, minabs!, trace, LambdaStaticData, dlsym_e, minimum, trailing_ones, LineNumberNode, minimum!, trailing_zeros, LoadError, done, minmax, transpose, LocalProcess, dones, mkdir, trigamma, MIME, dot, mkpath, tril, MS_ASYNC, download, mktemp, tril!, MS_INVALIDATE, drand, mktempdir, triu, MS_SYNC, drandn, mmap, triu!, MathConst, dump, mmap_array, trues, Matrix, dzeros, mmap_bitarray, trunc, MemoryError, mod, truncate, MergeSort, eachline, mod1, MersenneTwister, eachmatch, mod2pi, tuple, Meta, edit, modf, Method, eig, MethodError, eigfact, module_name, typeintersect, MethodTable, eigfact!, module_parent, typejoin, Module, eigmax, msync, typemax, NTuple, eigmin, mtime, typemin, NaN, eigs, mv, typeof, NaN16, eigvals, myid, ucfirst, NaN32, eigvecs, myindexes, uint, NewvarNode, names, uint128, None, nan, uint16, Nothing, eltype, nans, uint32, Number, empty!, nb_available, uint64, OS_NAME, ndigits, uint8, ObjectIdDict, endof, ndims, unescape_string, Operators, endswith, next, union, OrdinalRange, enumerate, nextfloat, union!, OverflowError, eof, nextind, unique, ParseError, eps, nextpow, unmark, PipeBuffer, erf, nextpow2, unsafe_copy!, Pkg, erfc, nextprod, unsafe_load, PollingFileWatcher, erfcinv, nfilled, unsafe_pointer_to_objref, ProcessExitedException, erfcx, nnz, unsafe_store!, ProcessGroup, erfi, nonzeros, unshift!, Profile, erfinv, norm, unsigned, Ptr, errno, normalize_string, uperm, QuickSort, error, normfro, uppercase, QuoteNode, esc, normpath, RTLD_DEEPBIND, escape_string, nothing, utf16, RTLD_FIRST, eta, notify, utf32, RTLD_GLOBAL, etree, nprocs, utf8, RTLD_LAZY, eu, nthperm, values, RTLD_LOCAL, eulergamma, nthperm!, var, RTLD_NODELETE, eval, ntoh, varm, RTLD_NOLOAD, evalfile, ntuple, vcat, RTLD_NOW, exit, null, vec, Range, exp, num, vecnorm, Range1, exp10, num2hex, versioninfo, RangeIndex, exp2, nworkers, wait, Ranges, expand, object_id, warn, Rational, expanduser, oct, watch_file, RawFD, expm, oftype, which, Real, expm1, one, Regex, exponent, ones, whos, RegexMatch, open, widemul, RemoteRef, extrema, operm, widen, RepString, eye, parent, with_bigfloat_precision, RevString, factor, parentindexes, with_bigfloat_rounding, RopeString, factorial, parse, with_rounding, RoundDown, factorize, parsefloat, workers, RoundFromZero, falses, parseint, workspace, RoundNearest, fd, parseip, write, RoundToZero, fdio, partitions, writecsv, RoundUp, fetch, peakflops, writedlm, RoundingMode, fft, permutations, writemime, STDERR, fft!, permute!, writesto, STDIN, fftshift, permutedims, wstring, STDOUT, fieldoffsets, permutedims!, xcorr, Set, fieldtype, pi, xdump, SharedArray, filemode, pinv, yield, SharedMatrix, filesize, plan_bfft, yieldto, SharedVector, fill, plan_bfft!, zero, Signed, fill!, plan_brfft, zeros, SparseMatrixCSC, filt, plan_dct, zeta, StackOverflowError, filt!, plan_dct!, zip, Stat, filter, plan_fft, StatStruct, filter!, plan_fft!, StepRange, finalizer, plan_idct, StridedArray, finally, plan_idct!, StridedMatrix, find, plan_ifft, StridedVecOrMat, find_library, plan_ifft!, StridedVector, findfirst, plan_irfft, String, findin, plan_rfft, SubArray, findmax, pmap, SubDArray, findmin, pointer, SubOrDArray, findn, pointer_from_objref, SubString, findnext, pointer_to_array, SymTridiagonal, findnz, poll_fd, Symbol, first, poll_file, SymbolNode, fld, polygamma, Symmetric, flipbits!, pop!, Sys, flipdim, popdisplay, SystemError, fliplr, position, Task, flipsign, powermod, Test, flipud, precision, TextDisplay, float, precompile, Timer, float16, prepend!, TmStruct, float32, prevfloat, Top, float32_isvalid, prevind, TopNode, float64, prevpow, Triangular, float64_isvalid, prevpow2, Tridiagonal, floor, prevprod},%
   keywords=[1]{abstract,begin,break,catch,const,continue,do,else,elseif,%
      end,export,false,for,function,immutable,import,importall,if,in,%
      macro,module,otherwise,quote,return,switch,true,try,type,typealias,%
      using,while, mutable, struct, immutable},
   sensitive=true,%
   alsoother={\$},%
   morecomment=[l]\#,%
   morecomment=[n]{\#=}{=\#},%
   morestring=[s]{"}{"},%
   morestring=[m]{'}{'},%
   alsoletter=!?,
}[keywords,comments,strings]%
\definecolor{backcolor}{rgb}{0.98,0.98,0.98}
\definecolor{numbergray}{rgb}{0.5,0.5,0.5}
\definecolor{stanfordred}{RGB}{140,21,21}
\definecolor{paloalto}{RGB}{23,94,84}
\definecolor{lagunita}{RGB}{0,124,146}
\definecolor{darkgreen}{RGB}{21,140,21}
\definecolor{darkblue}{RGB}{21,21,140}
\definecolor{sun}{RGB}{234,171,0}
\lstset{%
    language         = Julia,
    backgroundcolor  = \color[HTML]{F2F2F2},
    basicstyle       = \small\ttfamily\color[HTML]{19177C},
    numberstyle      = \ttfamily\scriptsize\color[HTML]{7F7F7F},
    keywordstyle     = \bfseries\color[HTML]{1BA1EA},
    keywordstyle     = [2]{\color[HTML]{0F6FA3}},
    keywordstyle     = [3]{\color[HTML]{0000FF}},
    stringstyle      = \color[HTML]{F5615C},
    commentstyle     = \color[HTML]{AAAAAA},
    frame=none,                 % A frame around the code
    tabsize=4,                  % Default tab size
    captionpos=b,               % Caption-position = bottom
    breaklines=true,            % Automatic line breaking
    breakatwhitespace=false,    % Automatic breaks only at whitespace?
    showstringspaces=false,     % Don't make spaces visible in strings
    showspaces=false,           % Don't make spaces visible elsewhere
    showtabs=false,             % Don't make tabs visible
    columns=fullflexible,       % Column format
    keepspaces=true,            % Keep spaces in code
    numbers=none,               % Line numbers
    numbersep=5pt,              % Line number separation
    % inputencoding=ansinew,
    inputencoding=utf8,
    extendedchars=true,
    literate={±}{{\textpm}}1
             {τ}{{$\tau$}}1
             {\{}{{\color[HTML]{0F6FA3}\{}}1
             {\}}{{\color[HTML]{0F6FA3}\}}}1
}
\newenvironment{algorithm}[1][htbp]
{\begin{mdframed}[backgroundcolor=black!5,rightline=false,leftline=false,innerbottommargin=0pt,innertopmargin=0pt,innerleftmargin=15pt,skipabove=4pt]}
{\end{mdframed}}